# Lezione di lunedì 15 aprile 2024

## Crittografia: Fondamenti

Arte di trasformare le informazioni di una certa rappresentazione in un'altra informazione la cui caratteristica è quella di avere una sintassi diversa rispetto alla prima ma una semantica identica alla precedente. Arte molto antica sin dall'antica grecia, gli anni 70 sono un decennio cruciale fino a quegli anni la cifratura era solo simmetrica (una sola chiave), dopo gli anni 70 nasce la cifratura asimmetrica, ENIGMA utilizzava una misura di cifratura simmetrica con una chiave che cambiava. Viene utilizzata spesso su internet HTTPS invece di HTTP o SSH al posto di Telnet.

Cifrare è come tradurre in un'altra lingua, cambia la sintassi (rappresentazione) ma non la semantica:

Encrypt: Ciao -> Hello
Decrypt: Hello -> Ciao

Le funzioni di encryption sono pubbliche e note a tutti.

La differenza tra cifratura e traduzione è la presenza di un parametro chiamato chiave crittografica, nella stringa cifrata normalmente non è possibile capire l'informazione contenuta in essa

Cifrario di Cesare (shift alfabetico): 

Encrypt(m,k): CIAO -> DLBP (m=ciao, k=chiave=1)
Decrypt(m,k): DLBP -> CIAO

Compito della cifratura è quello di nascondere la semantica di un messaggio, ma non la trasmissione del messaggio, informazione significativa in termini di privacy.

Rompere un messaggio cifrato: Apprendere la semantica senza conoscere la chiave di cifratura (senza dover fare decryption, con un pò di fortuna è anche possibile scoprire la chiave di encryption ma è molto più raro).

## Crittosistema

Cos'è un crittosistema? 
Una coppia di algoritmi:
- E per criptare producendo un crittotesto
- D per decriptare producendo un testo in chiaro

Ciascun algoritmo ha arietà due, ovvero un testo ed una chiave:
- Data una chiave k e un testo m, questo viene codificato
come E(m, k), indicato come mk
- Data una chiave k' e un crittotesto mk , questo viene
decodificato come D(mk , k'), che produce m se precise
condizioni legano k con k'
- Non deve essere necessariamente k = k'

Quando ho un crittotesto mk non è necessario che abbia caratteristiche per provare a decifrare il messaggio, ovvero applicare l'algoritmo di decryption, decifrare con successo significa scoprire il testo in chiaro di un messaggio cifrato.

La chiave può essere la stessa usata per cifrare (algoritmi simmetrici) oppure la chiave inversa in caso di criptoalgoritmi moderni ovvero asimmetrici.

Associazione tra testo in chiaro e cryptotesto dipende da un certo sistema.

## Crittografia in rete

Vedi slide 97

Se Alice vuole inviare un messaggio cifrato a Bob e solo Alice e Bob conoscono la chiave o le chiavi crittografiche solo loro potranno comunicare, Eve non conoscendo la chiave crittografica può solo provare a decifrarlo, anche tramite brute force, ma non c'è la certezza di riuscire ad effettuare ciò con successo.

## Segretezza di una chiave

Possibilità di fare un attacco brute-force sulla chiave di cifratura, se il segreto ha lunghezza k esistono 2^k possibili combinazioni di generazione della chiave di cifratura e la probabilità di indovinarla è di 1/2^k.
Importante quindi avere un numero k grande, spesso di 256 (AES 256).

La probabilità di leak della chiave di un algoritmo di cifratura non è mai superiore ad 1/2^k

## Crittografia simmetrica

Decifrare il testo per mezzo della stessa chiave utilizzata per la cifratura del messaggio.

Solo quando k' = k riuscirò a decifrare correttamente il messaggio.

**Equazione di correttezza:**
- D(E(m, k), k) = m La decryption per mezzo di k da come risultato m
- ∀k1. k1 != k −→ D(E(m, k), k1) != m Se k' != k non otterremo il messaggio di partenza m

Se l'attaccante prova a fare decryption usando chiavi a caso non otterrà il messaggio corretto decifrato.

Esempi: 
- Cifrario di Cesare, DES, 3DES 
- Tipica lunghezza di una chiave 128/256 bit
- Velocità

## Crittografia simmetrica in rete

Chiave a lungo termine dal punto di vista della sua validità, non è un segreto che cambia frequentemente, come il numero della nostra carta di credito o la nostra password che cambia ogni circa 6 mesi.

Un segreto che vale per molto tempo è un segreto importante, maggiore è il tempo di validità maggiore è l'importanza del segreto.

Alice ha la sua chiave a lungo termine, vuole inviare il suo messaggio in modo confidenziale e la cifra con quella chiave, Eve intercetta il criptotesto ma non riesce a decifrare con successo, siamo contenti dal punto di vista della confidenzialità, quando Bob riceverà il criptotesto proverà a decifrarlo ma deve conoscere la chiave.

Supponiamo che esista un modo sicuro per trasmettere la chiave in maniera confidenziale, Alice dovrebbe venire a conoscenza della chiave di Bob? No esiste un nesso tra chiave cifrata e password, e non è una furbata trasferire la chiave a lungo termine, la differenza sta nella lunghezza tra password (circa 8 caratteri, 64 bit) e chiave di cifratura (256 bit)

Chiave a breve termine: Chiave condivisibile tra Alice e Bob, il valore è contingente ovvero contestualizzato e parametrato alla sessione, ci serve un modo per trasmetterla, non posso inviarla in chiaro altrimenti è facile intercettarla e scoprire la chiave di cifratura.

## Limiti della crittofgrafia simmetrica

- Alice non vuole rilevare la chiave di cifratura a Bob
    - Inviamo quindi una chiave a breve termine che può essere condivisa fra i due utenti
- Scalabilità della soluzione: Se Alice vuole comunicare con Bob ha bisogno di una chiave di sessione specifica, se vuole parlare con Charlie ha bisogno di un'altra chiave di sessione specifica e diversa dalla precedente. Ogni coppia di utenti necessita di una chiave di sessione differente
- Come condividere la chiave di sessione in modo sicuro e confidenziale?

## Crittografia asimmetrica

- Ogni chiave k ha una sua chiave inversa k-1   
- Non è possbile ricavare k da k-1 e viceversa

Per decifrare con successo un testo cifrato con chiave k dovrò usare la sua chiave inversa k-1

**Equazione di correttezza:**
- D(E(m, k), k−1) = m 
- ∀k1. k1 != k−1 −→ D(E(m, k), k1) != m

Come generare le chiavi di cifratura? Il generatore di chiavi produce contestualmente la coppia di chiavi, metà la tiene per se (chiave privata) e metà la rende pubblica (chiave pubblica)

**Esempi di crittosistemi asimmetrici**
- DSA, RSA con chiave di 1024 bit, chiave molto più lunga della chiave simmetrica, non è più robusta ma la soglia è più elevata

Una operazione di encryption asimmetrica è più costosa computazionalmente di quella simmetrica, è utile quindi utilizzare sistemi ibridi che usino ambedue le tecnologie simmetrica ed asimmetrica.

Nella crittografia asimmetrica si suppone che ogni dispositivo abbia una coppia di chiavi una pubblica ed una privata.

## Crittografia asimmetrica in rete

Se si usa la chiave privata per cifrare bisogna utilizzare quella pubblica per decifrare.

Quando Alice sceglie di cifrare un messaggio ha a disposizione 3 chiavi:
- Chiave pubblica di Alice
- Chiave pubblica di Bob
- Chiave privata di Alice

Alice rende nota a tutti la chiave pubblica di A e tiene segreta k-1 la chiave privata di A per cifrare il messaggio, Bob riesce a decifrare il messaggio utilizzando la chiave pubblica.

Ma la chiave è pubblica, può utilizzarla quindi anche l'attaccante senza alcun problema.

Se l'obiettivo di sicurezza è l'autenticazione e non la segretezza, Alice cifra con una chiave privata e tutti possono decifrare usando la chiave pubblica di Alice, visto che la confidenzialità del messaggio non è importante e deducono che la chiave privata è quella di alice riescono ad autenticarla con successo.

Se l'obiettivo di sicurezza è la segretezza, allora sceglierà la chiave pubblica per cifrare ed è necessario conoscere la sua inversa per poterla decifrare correttamente.

## Limite della crittografia asimmetrica

Esistono problemi anche con la crittografia asimmetrica, come facciamo ad essere certi che la chiave pubblica di Alice sia effettivamente di Alice?

Alice cifra con la sua chiave privata, Bob decifra il messaggio con una chiave pubblica di X diverso da Alice, decifrando ottiene un messaggio leggibile e comprensibile il che significa che autenticherà X invece di Alice, serve quindi **Certificazione**.

Altro esempio:
Alice intende mandare a Bob un messaggio in maniera confidenziale usando la chiave di cifratura pubblica di Bob, ma Alice potrebbe erroneamente prendere la chiave pubblica di X diverso da Bob e recapitare il messaggio ad un altro utente

## Riepilogo crittografia simmetrica ed asimmetrica

- Crittografia simmetrica: Come condividere il messaggio in maniera sicura
- Crittografia asimmetrica: Come verificare il proprietario di una chiave pubblica (certificazione)

Come utilizzare queste tecniche per ottenere le proprietà di sicurezza di livello 1? Segretezza, Autenticazione ed Integrità

## Crittosistema sicuro

Crittosistema sicuro se la probabilità di scoprire la chiave crittografica non miglori nonostante la pubblicità dell'algoritmo.

## Hash Crittografico

Caratteristiche:
- Calcolo dell'hash molto semplice
- Se parto da un valore hash non riesco a generare il messaggio il cui hash sia quel valore dato, non riesco ad invertire l'hash
- Se cambio anche 1 solo bit del messaggio l'hash varierà completamente generando codici completamente differenti

Hashing e Cifratura sono differenti perchè tramite hash è possibile 

Le funzioni hash hanno in input un dato, le funzioni di encryption prendono in input 2 parametri

## CTSS + Hashing

Spiega come vengono salvate ad oggi le password in memoria.

## Salting

Il **salt** indica un messaggio random, inizialmente di 12 bit oggi insufficienti, aggiunto ad una password per proteggerla da attacchi dizionario prima che vi si applichi l'hash

Unix come salvava le password in memoria?
Generazione salt per ciascuna password da memorizzare, usa la password per codificare una stringa di zeri insieme a salt mediante la password di encryption function crypt(3) basata su DES

Usare una funzione di encryption per generare una funzione hash sperando di soddisfare i requisiti delle funzioni hash, crypt(3) ne è l'esempio storico. Prevede l'encryption di una stringa di zeri allungata con 12 bit di sale randomici, è una discreta funzione hash per il tempo.

Utilizzo furbo di un algoritmo di encryption che soddisfa le caratteristiche di una funzione hash.

Il sale serve a complicare la vita in caso di attacco, il pepper anche se fisso allunga l'input e ad ogni bit di pepper la tabella di rottura dell'hash raddoppierà precalcolando tutti i possibili input.

## Unix: Aggiunta di una nuova password

1) Ottengo 56 bit sfruttando i 7 bit meno significativi dei primi 8 caratteri della password
2) Viene criptato sale e stringa di zeri
3) Password non più memorizzata come testo in chiaro

## Tabella Rainbow

Modello di attaccante per invertire l'hash

## Domande di esame

- Limiti della cifratura: Un messaggio cifrato non è nascosto, si vede ed è un problema significativo in termini di privacy (informazione utile in termini di analisi forense e spionaggio)
- Cos'è un crittosistema?
- Come scambiare in modo sicuro le chiavi crittografiche
- Definizione formale di crittografia simmetrica (usare le formule matematiche di pagina 99)
- Password e chiave a lungo termine requisiti di segretezza e confidenzialità
- Generazione delle chiavi di cifratura
- Come ottenere segretezza con crittografia asimmetrica?
- Come ottenere autenticazione con crittografia asimmetrica?
- Weakness della cifratura asimmetrica (certificazione)
- Proprietario di una chiave pubblica: Chi ha l'altra metà privata della chiave
- Definizione di Crittosistema sicuro
- Differenza tra hashing ed encryption
- Brute forcing sull'hash per invertire l'hash
- Utilizzo di salt e pepper nella memorizzazione delle password

## Ricerche per casa

- Diffie Hellman key exchange
- Standard cifratura simmetrica AES 256