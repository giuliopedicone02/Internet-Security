# Lezione di lunedì 22 aprile 2024

## Firma Digitale

Assicura sia l'integrità che l'autenticazione.
Non esiste una soluzione che garantisca l'integrità senza l'autenticazione.
Sfruttiamo anche la proprietà di autenticazione, cifrando con la chiave privata del mittente.

Effettuare una firma digitale significa utilizzare un paio di algoritmi, uno per creare la firma e uno per verificarla. Si invia il documento in chiaro insieme alla cifratura del digest. Questo processo combina autenticazione e integrità, ma non confidenzialità e integrità.

Nessuno può firmare per conto di un altro, ma tutti possono verificare la firma digitale, poiché tutti conoscono la chiave pubblica del mittente.

## Combinare tutte le proprietà di livello 1

La firma digitale risolve il problema delle falsificazioni.
La firma tradizionale offre solo un livello di autenticazione ed è facilmente falsificabile.

Per quanto riguarda la segretezza del messaggio (m) tra A e B, l'autenticazione di A con B e l'integrità di m durante la trasmissione da A a B, è necessario considerare che tutti i protocolli basilari presentati sono vulnerabili agli attacchi di ripetizione e non incorporano meccanismi di freschezza.

Prima di esaminare protocolli più avanzati, manteniamo due promesse fondamentali:
1. Utilizzo della crittografia simmetrica: condivisione di un segreto iniziale.
2. Utilizzo della crittografia asimmetrica: certificazione.

Per ottenere ciò, verranno impiegati protocolli dedicati:
1. Per la crittografia simmetrica: Diffie-Hellmann (DH) o RSA Key Exchange.
2. Per la crittografia asimmetrica: Public-Key Infrastructure (PKI).

## Protocollo Diffie-Hellmann

- Alice e Bob concordano due parametri pubblici molto grandi, alpha e beta, correlati tra loro.
- Alice genera un numero casuale privato, Xa.
    - Successivamente calcola Ya = alpha^Xa mod beta (pubblico).
- Bob genera un numero casuale privato, Xb.
    - Successivamente calcola Yb = alpha^Xb mod beta (pubblico).
- Alice e Bob eseguono lo scambio di chiavi.
- Bob, alla ricezione, calcola Ya^Xb modulo beta.
- Alice, alla ricezione, calcola Yb^Xa modulo beta.

(In questo modo si ottiene lo stesso numero, che rappresenta la chiave di sessione condivisa tra Alice e Bob.)

Questo protocollo è legato alla crittografia asimmetrica? **NO**, ma la crittografia asimmetrica si ispira ad esso.

Le Y sono pubbliche mentre le X sono private. Questo schema presenta delle vulnerabilità? Esiste un'operazione che consenta a chiunque intercetti le Y di derivare le X?

Per calcolare l'esponente, sarebbe necessario applicare l'operazione del logaritmo base alpha all'espressione alpha elevato a Xa, il che è uguale a Xa.

Tuttavia, essendo applicata anche l'operazione modulo, bisognerebbe effettuare l'operazione di logaritmo discreto, che risulta essere intrattabile e onerosa per numeri alpha e beta molto grandi.

In pratica, dato Ya, non è possibile ricavare Xa in tempi ragionevoli.

Non vi è autenticazione tra Alice e Bob; sebbene la confidenzialità sia assicurata, l'assenza di autenticazione non garantisce la confidenzialità, poiché non possiamo essere certi di comunicare con Bob ma potremmo trovarci a comunicare con Charlie.

## Attacco man in the Middle su Diffie-Hellman

- Alice invia a Bob Ya.
- Charlie intercetta Ya e invia a Bob Yc.
- Bob invia ad Alice Yb.
- Charlie intercetta Yb e invia ad Alice Yc.

In questo scenario, i due interlocutori avranno valori diversi l'uno dall'altro. Tuttavia, l'attaccante, sfruttando le proprietà dell'esponenziazione, prende Ya e Yb e li eleva a Xc, calcolando così k1 e k2.

## Diffie-Hellman: Attacco al microscopio

I problemi associati a Diffie-Hellman sono di due tipi.

Se l'attaccante avesse semplicemente inviato le sue proprie Yc senza conoscere Ya e Yb, non sarebbe stato in grado di completare l'attacco e di calcolare k1 e k2.

## Come irrobustire Diffie-Hellman

Il primo ricorso ufficiale alla crittografia asimmetrica è una delle mosse per rafforzare Diffie-Hellman. Una delle due versioni di Diffie-Hellman è utilizzata in IPsec.

L'approccio congiunto tra crittografia asimmetrica e simmetrica, che è più veloce ed efficiente, è un'altra strategia di irrobustimento.

Per proteggere contro l'attacco alla confidenzialità, si può adottare la cifratura con la chiave pubblica del destinatario. In questo modo, anche se l'attaccante intercetta i valori Ya e Yb, non sarà in grado di decifrarli senza la chiave privata del destinatario.

Per prevenire l'attacco all'autenticazione, si può utilizzare la codifica con la chiave privata del mittente. Anche se l'attaccante riuscisse a intercettare Ya e Yb, non sarebbe in grado di fornire ai destinatari la propria Yc, poiché dovrebbe cifrarla con la chiave del mittente, che l'attaccante non possiede.

## RSA Key Exchange

Alternativa a Diffie-Hellmann basata su crittografia asimmetrica. Nel mondo asimmetrico esiste ancora il problema della certificazione.

## Personal Identifiable Information (P.I.I.)

Il nome e il cognome non identificano univocamente una persona; sono necessarie ulteriori informazioni, come il codice fiscale.

Nella carta di identità, un elemento che attesta l'autenticità è il numero di carta di identità, che autentica anche il produttore della carta di identità.

Gli elementi fondamentali in una carta di identità sono almeno tre:
- Anagrafica
- Fotografia
- Produttore

Queste tre informazioni devono essere prodotte per garantire l'integrità e per essere riconoscibili e non sostituibili.

A e Ka rappresentano l'anagrafica e la chiave privata di A, mentre CA (Autorità di Certificazione) è l'ente che emette il certificato.

Il compito della CA è quello di mettere insieme, tramite cifratura, {A, ka}, cifrati con la chiave inversa di CA (Kca-1). Questo avviene attraverso una firma digitale primitiva crittografica, che rappresenta una misura che combina autenticazione ed integrità.

Esiste una catena di certificati e, di conseguenza, una catena di atti di fiducia che culmina con la root, che nel caso della carta di identità è il ministro degli interni.

I certificati vengono firmati sempre dall'ente che si trova più in alto nella catena, fino ad arrivare al livello 0, in cui il certificato viene firmato dallo stesso ente che lo produce.

RCA: Root Certification Authority

Sul certificato radice, facciamo un atto di fede.

## Certificazione (Crittografia asimmetrica)

Un certificato è paragonabile a una carta d'identità e possiede caratteristiche di grande valore, tra cui la fiducia. Un'autorità di certificazione vende fiducia, e dietro le CA ci sono spesso consorzi di banche.

Il valore di un certificato deriva dall'autorevolezza di chi lo emette e dalla libertà di chi lo riceve nel decidere se accettarlo o meno.

I certificati seguono uno standard chiamato X509.

L'origine dell'albero delle certificazioni è autocertificante, quindi rappresenta un atto di fede.

I fornitori di identità digitale sono regolamentati dalla legge italiana. Gli URL hanno bisogno di questi certificati, e ci sono problematiche relative alla certificazione dei wildcard per coprire anche i sottodomini.

Ad esempio, se unict.it è certificato, questo implica che anche dmi.unict.it lo sia? Non necessariamente, poiché non esiste un'implicazione logica diretta.

TLS è un protocollo crittografico che utilizza una combinazione di cifratura simmetrica e asimmetrica, e richiede la certificazione, ma la radice della certificazione richiede un atto di fede.

Come fa il browser a sapere chi è l'autorità di certificazione radice? Ogni browser possiede un database di certificati TLS. Se il browser possiede la root, può certificare l'intera catena di certificati.

Ogni browser fornisce un insieme diverso di certificati di root, che possono variare.

## Domande di esame

- Non sottovalutare le assunzioni all'esame orale
- Schema base per l'integrità (abbinamento delle assunzioni che servono per l'autenticazione)
- La firma grafometrica, vulnerabilità (alterabilità, falsificazioni)
- Operazione insiemistica per derivare le assunzioni che permettono di combinare le proprietà di livello 1? (Le sommo)
- Diffie Hellmann, protocollo che appare elementare ma che in realtà è molto complesso
- Primitiva crittografica (Encryption, Hashing, Firma Digitale)
- Consorzi di banche dietro le CA

## Ricerche per casa

- Protocollo diffie-hellmann
- Google disthrust symantec
- Dove sta lo store dei certificati di root del browser